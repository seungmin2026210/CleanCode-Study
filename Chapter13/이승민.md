

## 🔶 13장 동시성 

# 💌 책에서 기억하고 싶은 내용

▪ 동시성은 무엇과 언제를 분리하여 결합을 없애는 전략이다.
▪ 하지만 동시성은 부하를 유발하고 복잡하며 버그 재현이 어렵고 구현하려면 근본적인 설계 전략을 재고해야 한다.
▪ 동시성 방어를위해서는 동시성 코드를 다른 코드와 분리하고 자료를 캡슐화하며 자료 사본을 사용하고 독자적인 스레드로 사용해야한다.
▪ 공유 객체 하나에는 메서드 하나만 사용한다.
▪ 만약 공유 객체 하나에 여러 메서드가 필요한 상황이라면 아래 3가지에 유의한다.
   1. 클라이언트에서 첫 번째 메서드를 호출 하기 전에 서버를 잠근다.
   2. 서버를 잠그고 모든 메서드를 호출 한 후 잠금을 해제하는 메서드를 구현한다.
   3. 잠금을 수행하는 중간 단계를 생성한다.
 
▪ 동기화 하는 부분을 작게 만든다.
▪ 올바른 종료 코드를 짜기 위해 시간을 투자한다.
▪ 코드 테스트는 프로그램 설정과 시스템 설정, 부하를 바꿔가며 자주 돌린다.
▪ 시스템 실패를 일회성으로 치부하지 말아라
▪ 다중 쓰레드를 쓰는 코드 부분을 다양한 환경에 쉽게 끼워넣을 수 있게 스레드코드를 구현해라.
▪ 드물게 발생하는 오류를 더 자주 일으키려면 보조 코드를 추가해 코드가 실행되는 순서를 바꿔본다.



<br>

# 💬 소감
동시성에 대해서 조금 더 구글링을 해 보았다.
동시성은 어떤 두 사건이 같은 시간에 일어나는 것을 말하고,
웹 서버는 여러개의 요청을 동시에 수행할 수 있으며 이는 작성한 코드가 동시에 수행될 수 있다는 의미가 된다.
쉽게 말하면 두 명의 사용자가 실시간으로 좋아요를 클릭하면 최종 좋아요의 cnt는 +2가 되어야 하지만, cnt+1을 하기 위해 좋아요 수를 조회 하였을 때 값은 모두 0이기 때문에 최종 좋아요의 증가값이 +1이 되는 문제점이라고 한다.
무작정 '동기화가 좋아', '깔끔한 코드가 좋아' 하며 오로지 그것만을 목표로 프로그램을 구현하는 것이 아니라
내가 만드는 프로그램을 이해하고 구조를 꼼꼼하게 잘 짜고 상황에 맞는 적절한 기법을 사용하며, 꼼꼼하게 오류가 없는지 확인하는 것이 중요하구나 하는 걸 느꼈다.
사실 지금까지는 DB에 데이터가 저절로 꼽히면 내가 구현을 하는 방식이라 위 예시처럼 실시간으로 돌아가는 무언가를 만들어 본적이 없다. 
기회가된다면 SNS 클론 코딩을 통해 좋아요 기능을 직접 만들어 오류를 직면하고 해결 해 보고싶다는 생각이 들었다.

<br>

# 💥 이해 안 가는 부분
- 이해가지 않는 부분은 없었다.
